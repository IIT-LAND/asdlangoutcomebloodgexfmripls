1. Open MATLAB, add plsgui to the path if its not already on your matlab path, and then type plsgui at command prompt

2. Click the buttons Structural and Run PLS Analysis on Structural data

3. A window will now be open at the top it will say Datamat File and then have an Add button. Click Add. You will be selecting a *STRUCTsessiondata.mat for each group.

4. You will now select the *STRUCTsessiondata.mat for each group. These are located in the data/tidy/ directory. Group #1 should be Good_STRUCTsessiondata.mat. Once this is done, repeat step 3 (i.e. click Add) and now for Group #2 you should select Poor_STRUCTsessiondata.mat. Repeat step 3 and select for Group #3 TD_STRUCTsessiondata.mat. The groups must be specified in this order (e.g., Good, Poor, TD).

5. In the middle of the window it says PLS Option. Here you will select Regular Behave PLS, and then click the Load behavior data button. Here you will load in the ME data from the WGCNA. One this is finished, make sure the Correlation Mode is set to 0, which it should be by default already.

6. Click Load and select data4pls.txt from the WGCNAresults directory. For the Behavior Name field, manually enter M1 through to M21.

7. At the bottom, enter the number of permutations (10000) and bootstrap (10000). Also have Confidence Level set to 95 and unselect the checkbox for Use segment data.

8. Click Run at the bottom. A pop will ask you to name the result mat file it will save. Save this file to the PLSresults directory with the filename Subgrp_STRUCTresult.mat, and then it will run the PLS analysis.

9. Manually load the Subgrp_STRUCTresult.mat file, and compute percent cross block covariance explained and once finished re-save the .mat file. To compute this, use the following code:

result.crossblockCovPercent = result.s.^2/sum(result.s.^2);

10. Run the following code in MATLAB

% rootpath = path above PLSresults
resultmat = fullfile(rootpath,’PLSresults’,’Subgrp_STRUCTresult.mat’);
cd(codedir); % codedir is the code directory
[tab2write] = compute_bootstrap_ci_pls(resultmat,1);




Repeat steps 2-9 for the analysis of Cases vs Controls (e.g., ASD Good and Poor lumped into one ASD group). However, in that analysis, for step 4, you specify the first data mat as ASD_STRUCTsessiondata.mat as Group 1, and TD_STRUCTsessiondata.mat as Group 2. On step 8, save the file as CaseCtrl_STRUCTresult.mat.